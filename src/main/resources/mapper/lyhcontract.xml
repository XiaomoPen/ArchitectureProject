<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.seven.springboot.mapper.lyh.LyhContractDao">
    <resultMap id="allContract" type="com.seven.springboot.pojo.TPmContract">
        <id column="contract_number" property="contractNumber"></id>
        <result column="user_number" property="userNumber"></result>
        <result column="contract_name" property="contractName"></result>
        <result column="contract_leix" property="contractLeix"></result>
        <result column="contract_state" property="contractState"></result>
        <result column="contract_sy" property="contractSy"></result>
        <result column="contract_positive" property="contractPositive"></result>
        <result column="contract_signing" property="contractSigning"></result>
        <result column="contract_effect" property="contractEffect"></result>
        <result column="contract_failure" property="contractFailure"></result>


        <association property="user" javaType="com.seven.springboot.pojo.TPmUser">
            <id column="user_number" property="userNumber"></id>
            <result column="user_Jobnumber" property="userJobNumber"></result>
            <result column="user_name" property="userName"></result>
            <result column="user_sex" property="userSex"></result>
            <result column="user_birthday" property="userBirthday"></result>
            <result column="user_intime" property="userIntime"></result>
            <result column="user_positive" property="userPositive"></result>
            <result column="user_departure" property="userDeparture"></result>
            <result column="position_number" property="positionNumber"></result>
            <result column="department_number" property="departmentNumber"></result>
            <result column="user_state" property="userState"></result>


            <association property="department" javaType="com.seven.springboot.pojo.TPmDepartment">
                <id column="department_number" property="departmentNumber"></id>
                <result column="department_name" property="departmentName"></result>
                <result column="department_time" property="departmentTime"></result>
                <result column="user_number" property="userNumber"></result>
            </association>

            <association property="tPmPosition" javaType="com.seven.springboot.pojo.TPmPosition">
                <id column="position_number" property="positionNumber"></id>
                <result property="position_name" column="positionName"></result>
                <result column="position_time" property="positionTime"></result>
                <result column="user_number" property="userNumber"></result>
            </association>

        </association>

    </resultMap>

    <select id="gj" resultMap="allContract">
        select * from t_pm_contract a
                          left JOIN t_pm_user b on a.user_number=b.user_number
                          LEFT JOIN t_pm_position c on b.position_number=c.position_number
                          LEFT JOIN t_pm_department d on b.department_number=d.department_number
<where>
    <if test="user.userName !=null and user.userName !=''">
    and b.user_name like '%${user.userName}%'
    </if>
<if test="contractLeix !=null and contractLeix !=''">
    and a.contract_leix like '%${contractLeix}%'
</if>
</where>
    </select>

    <insert id="addContract">
        insert  into t_pm_contract(contract_number,user_number,
        contract_name,contract_leix,contract_state,contract_sy,
        contract_positive,contract_signing,
        contract_effect,contract_failure) values(
              #{contractNumber},#{userNumber},#{contractName},
            #{contractState},#{contractSy},#{contractPositive},
            #{contractSigning},#{contractEffect},#{contractEffect},#{contractFailure})
    </insert>

<delete id="delContract">
    delete from t_pm_contracr where contract_number=#{contractNumber}
</delete>

</mapper>